#ATTENTION!
#
#DO NOT MODIFY THIS FILE BECAUSE IT WAS GENERATED AUTOMATICALLY,
#SO ALL YOUR CHANGES WILL BE LOST THE NEXT TIME THE FILE IS GENERATED.

fastcgi_cache_path /var/cache/nginx/bdstotnhat.com_fastcgi levels=1:2 keys_zone=bdstotnhat.com_fastcgi:5m max_size=67108864;

server {
        listen 45.32.38.199:443 ssl http2;

        server_name bdstotnhat.com;
        server_name www.bdstotnhat.com;
        server_name ipv4.bdstotnhat.com;

        ssl_certificate             /opt/psa/var/certificates/scf2Q6t76;
        ssl_certificate_key         /opt/psa/var/certificates/scf2Q6t76;

        client_max_body_size 128m;

        # mailconfig
        location ~* ^/autodiscover/autodiscover\.xml$ {
                try_files $uri @mad;
        }
        location ~* ^(/\.well-known/autoconfig)?/mail/config\-v1\.1\.xml$ {
                try_files $uri @mad;
        }

        location  ~* ^/email\.mobileconfig$ {
                try_files $uri @mad;
        }

        location @mad {
                rewrite ^(.*)$ /mailconfig/ break;

                proxy_pass                          http://127.0.0.1:8880;
                proxy_set_header X-Host             $host;
                proxy_set_header X-Request-URI      $request_uri;
        }
        # mailconfig

        root "/var/www/vhosts/bdstotnhat.com/httpdocs";
        access_log "/var/www/vhosts/system/bdstotnhat.com/logs/proxy_access_ssl_log";
        error_log "/var/www/vhosts/system/bdstotnhat.com/logs/proxy_error_log";

        add_header X-Cache-Status $upstream_cache_status;
        set $no_cache "";

        set $cache_cookie $http_cookie;

        if ($cache_cookie !~ "^\s*$") {
                set $no_cache 1;
        }

        #extension letsencrypt begin
        location ^~ /.well-known/acme-challenge/ {
                root /var/www/vhosts/default/htdocs;

                types { }
                default_type text/plain;

                satisfy any;
                auth_basic off;
                allow all;

                location ~ ^/\.well-known/acme-challenge.*/\. {
                        deny all;
                }
        }
        #extension letsencrypt end

        #extension sslit begin

        #extension sslit end

        #extension sectigo begin
        location ^~ /.well-known/pki-validation/fileauth.txt {
                try_files $uri $uri/ =404;
        }

        location ^~ /.well-known/pki-validation/ {
                root /var/www/vhosts/default/htdocs;

                types { }
                default_type text/plain;

                satisfy any;
                auth_basic off;
                allow all;

                location ~ ^/\.well-known/pki-validation.*/\. {
                        deny all;
                }
        }
        #extension sectigo end

        error_page 400 "/error_docs/bad_request.html";
        error_page 401 "/error_docs/unauthorized.html";
        error_page 403 "/error_docs/forbidden.html";
        error_page 404 "/error_docs/not_found.html";
        error_page 500 "/error_docs/internal_server_error.html";
        error_page 405 "/error_docs/method_not_allowed.html";
        error_page 406 "/error_docs/not_acceptable.html";
        error_page 407 "/error_docs/proxy_authentication_required.html";
        error_page 412 "/error_docs/precondition_failed.html";
        error_page 414 "/error_docs/request_uri_too_long.html";
        error_page 415 "/error_docs/unsupported_media_type.html";
        error_page 501 "/error_docs/not_implemented.html";
        error_page 502 "/error_docs/bad_gateway.html";
        error_page 503 "/error_docs/maintenance.html";

        location ^~ /error_docs {
                root "/var/www/vhosts/bdstotnhat.com";
        }

        location ~ /\.ht {
                deny all;
        }

        location ~ ^/(plesk-stat|awstats-icon|webstat|webstat-ssl|ftpstat|anon_ftpstat) {
                auth_basic "Domain statistics";
                auth_basic_user_file "/var/www/vhosts/system/bdstotnhat.com/pd/d..httpdocs@plesk-stat";
                autoindex on;

                location ~ ^/plesk-stat(.*) {
                        alias /var/www/vhosts/system/bdstotnhat.com/statistics/$1;
                }

                location ~ ^/awstats-icon(.*) {
                        alias /usr/share/awstats/icon/$1;
                }

                location ~ ^/(.*) {
                        alias /var/www/vhosts/system/bdstotnhat.com/statistics/$1;
                }
        }
        ## Set the location routing.
        location ~ / {

            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;

            ##Use the domain.tld here.
            proxy_pass http://45.32.38.199:3000;
        }

        add_header X-Powered-By PleskLin;

}

server {
        listen 45.32.38.199:80;

        server_name bdstotnhat.com;
        server_name www.bdstotnhat.com;
        server_name ipv4.bdstotnhat.com;

        client_max_body_size 128m;

        # mailconfig
        location ~* ^/autodiscover/autodiscover\.xml$ {
                try_files $uri @mad;
        }
        location ~* ^(/\.well-known/autoconfig)?/mail/config\-v1\.1\.xml$ {
                try_files $uri @mad;
        }

        location  ~* ^/email\.mobileconfig$ {
                try_files $uri @mad;
        }

        location @mad {
                rewrite ^(.*)$ /mailconfig/ break;

                proxy_pass                          http://127.0.0.1:8880;
                proxy_set_header X-Host             $host;
                proxy_set_header X-Request-URI      $request_uri;
        }
        # mailconfig

        location / {
                return 301 https://$host$request_uri;
        }
}